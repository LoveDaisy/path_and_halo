function test_project_polygon_intersection()
test_cases = {@suite1, @suite2};
num = length(test_cases);

fprintf('Start testing for project_polygon_intersection...\n');
for i = 1:num
    fprintf('Testing suite %d/%d...\n', i, num);
    test_cases{i}();
    fprintf('suite %d/%d passed!\n', i, num);
end
end

% ================================================================================
function suite1()
vtx_from = [.7, - .3, 1;
        .7, - .3, 2;
        -1, .3, 2;
        -1, .3, 1];
vtx_to = [0, 0, 0;
    1, 0, 0;
    1, 1, 0;
    0, 1, 0];

fprintf(' case 1 ... ');
ray = [0, 1, -2];
vtx0 = [0.7, 0.2, 0;
    0.7, 0.7, 0;
    0, 0.9471, 0;
    0, 0.4471, 0];
a0 = 0.4118;

[area_factor, vtx] = geo.project_polygon_intersection(vtx_from, vtx_to, ray);
assert(all(abs(vtx(:) - vtx0(:)) < 5e-5));
assert(abs(a0 - area_factor) < 5e-5);
fprintf('passed\n');

fprintf(' case 2 ... ');
ray = [2, 1, -1.5];
vtx0 = [0.4, 1, 0;
    0.33333, 0.96667, 0;
    1, 0.73137, 0;
    1, 1, 0];
a0 = 0.0515;

[area_factor, vtx] = geo.project_polygon_intersection(vtx_from, vtx_to, ray);
assert(all(abs(vtx(:) - vtx0(:)) < 5e-5));
assert(abs(a0 - area_factor) < 5e-5);
fprintf('passed\n');
end

% ================================================================================
function suite2()
vtx_from = [0.291572994095090, -0.135085301737031, 0.629870741000914;
        0.477810746998982, -0.439739123272843, 0.279868528983712;
        0.642781243665411, -0.251782341095105, -0.153094498609895;
        0.621513987427949, 0.240828262618445, -0.236055314186299;
        0.435276234524058, 0.545482084154257, 0.113946897830903;
        0.270305737857628, 0.357525301976519, 0.546909925424509];
vtx_to = [0.291572994095090, -0.135085301737031, 0.629870741000914;
    - 0.621513987427949, -0.240828262618445, 0.236055314186299;
    - 0.435276234524058, -0.545482084154257, -0.113946897830903;
    0.477810746998982, -0.439739123272843, 0.279868528983712];
ray = [-0.956106383925158, -0.0253340196909074, -0.291922541205470];

vtx0 = [0.291572994095090, -0.135085301737031, 0.629870741000914;
    0.477810746998982, -0.439739123272843, 0.279868528983712;
    - 0.485530426804620, -0.463274628964601, -0.0195026823746974;
    - 0.621513987427949, -0.240828262618445, 0.236055314186299;
    0.291572994095090, -0.135085301737031, 0.629870741000914];
a0 = 0.00312605591934092;

[area_factor, vtx] = geo.project_polygon_intersection(vtx_from, vtx_to, ray);
assert(all(abs(vtx(:) - vtx0(:)) < 5e-5));
assert(abs(a0 - area_factor) < 5e-5);
end
